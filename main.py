# -*- coding: utf-8 -*-
from transformers import pipeline
from transformers import AutoModelForSeq2SeqLM, T5TokenizerFast
import torch
from transformers import AutoModelForSequenceClassification
from transformers import BertTokenizerFast
import nltk
from openpyxl import load_workbook
from nltk.tokenize import word_tokenize,sent_tokenize
from get_All import get_All
from nltk.corpus import stopwords
from nltk.stem.snowball import SnowballStemmer
import pandas as pd
from summ import sum

#nltk.download('popular')
#nltk.download('punkt')
#nltk.download('stopwords')

tokenizer = BertTokenizerFast.from_pretrained('blanchefort/rubert-base-cased-sentiment-rusentiment')
model = AutoModelForSequenceClassification.from_pretrained('blanchefort/rubert-base-cased-sentiment-rusentiment', return_dict=True)

countp = 2
counto = 2
counts = 2
countnege = 2
countne = 2
countpose = 2
countneg = 0
countn = 0
countpos = 0

MODEL_NAME = 'UrukHan/t5-russian-summarization'
MAX_INPUT = 10000

tokenizer1 = T5TokenizerFast.from_pretrained(MODEL_NAME)
model1 = AutoModelForSeq2SeqLM.from_pretrained(MODEL_NAME)



def summ(word):
    input_sequences = [word]
    if len(word)> 600:
        task_prefix = "Spell correct: "  # –¢–æ–∫–µ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
        if type(input_sequences) != list: input_sequences = [input_sequences]
        encoded = tokenizer1(
            [task_prefix + sequence for sequence in input_sequences],
            padding="longest",
            max_length=MAX_INPUT,
            truncation=True,
            return_tensors="pt",
        )

        device = torch.device('cpu')

        predicts = model1.generate(**encoded.to(device))  # # –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ

        return tokenizer1.batch_decode(predicts, skip_special_tokens=True)
    else:
        return word



def get_toxicity(predict):
    if (predict == 0):
        return "–¢–µ–∫—Å—Ç –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–π"
    elif (predict == 1):
        return "–¢–µ–∫—Å—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π"
    else:
        return "–¢–µ–∫—Å—Ç –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã–π"




@torch.no_grad()
def predict(text):
    inputs = tokenizer(text, max_length=512, padding=True, truncation=True, return_tensors='pt')
    outputs = model(**inputs)
    predicted = torch.nn.functional.softmax(outputs.logits, dim=1)
    predicted = torch.argmax(predicted, dim=1).numpy()
    return predicted


comment = {
"–ô–û–ì–ê –ò –≠–ó–û–¢–ï–†–ò–ö–ê –í–ú–ï–°–¢–û –ü–°–ò–•–û–õ–û–ì–ò–ò –ë—ã–≤—à–∞—è –∫–∞—Ñ–µ–¥—Ä–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ—à–ª–∞ –≤ –ò–¢-–∏–Ω—Å—Ç–∏—Ç—É—Ç –Ω–µ –±–µ–∑ –ø–æ—Ç–µ—Ä—å. –ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å–Ω–∏—Ü–∞ –ù–∞—Ç–∞–ª–∏—è –ë—è—á–∫–æ–≤–∞, –∫–æ—Ç–æ—Ä–∞—è –≤–µ–ª–∞ —É –±–µ–∑–æ–ø–∞—Å–Ω–∏–∫–æ–≤ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—é, –æ—Å—Ç–∞–ª–∞—Å—å –±–µ–∑ –Ω–∞–≥—Ä—É–∑–∫–∏. –°–µ–π—á–∞—Å –æ–Ω–∞ —á–∏—Å–ª–∏—Ç—Å—è –Ω–∞ –º–µ—Ö–º–∞—Ç–µ –∏ –Ω–µ –≤–µ–¥—ë—Ç –Ω–∏–∫–∞–∫–∏—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤, —Ö–æ—Ç—è –∑–∞–∫–ª—é—á–∏–ª–∞ —Å –ü–ì–ù–ò–£ –∫–æ–Ω—Ç—Ä–∞–∫—Ç –¥–æ 2026 –≥–æ–¥–∞*. –¢–µ–ø–µ—Ä—å —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–∞ –æ–±—è–∑–∞–Ω–æ –æ–±–µ—Å–ø–µ—á–∏—Ç—å –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å–Ω–∏—Ü—É —Ä–∞–±–æ—Ç–æ–π, –Ω–æ –¥–æ —Å–∏—Ö –ø–æ—Ä —ç—Ç–æ–≥–æ –Ω–µ —Å–¥–µ–ª–∞–ª–æ. –ë—è—á–∫–æ–≤–∞ –º–æ–≥–ª–∞ –±—ã –≤–µ—Å—Ç–∏ –ø—Ä–µ–¥–º–µ—Ç—ã —É —Å—Ç–∞—Ä—à–µ–∫—É—Ä—Å–Ω–∏–∫–æ–≤ –º–µ—Ö–º–∞—Ç–∞ –∏–ª–∏ —É –Ω–æ–≤–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –ò–¢-–∏–Ω—Å—Ç–∏—Ç—É—Ç–∞, –Ω–æ –Ω–∞–≥—Ä—É–∑–∫—É –æ—Ç–¥–∞–ª–∏ –∫–∞—Ñ–µ–¥—Ä–µ –ø—Å–∏—Ö–æ–ª–æ–≥–∏–∏ —Ä–∞–∑–≤–∏—Ç–∏—è**. –ò—Å—Ç–æ—á–Ω–∏–∫ —É—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ –Ω–∞ –Ω–µ–π –Ω–µ—Ç —Ä–∞–±–æ—Ç–Ω–∏–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –±—ã —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∏—Å—å –Ω–∞ —Ç–æ–º, —á—Ç–æ –Ω—É–∂–Ω–æ –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–∏–∫–æ–≤. –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —Å—Ç—É–¥–µ–Ω—Ç—ã –æ—Å—Ç–∞–ª–∏—Å—å –Ω–µ–¥–æ–≤–æ–ª—å–Ω—ã —Ç–∞–∫–æ–π —Ä–æ–∫–∏—Ä–æ–≤–∫–æ–π: –ø–æ–∂–∞–ª–æ–≤–∞–ª–∏—Å—å –Ω–∞ —Ç–æ, —á—Ç–æ –Ω–∞ –ø–∞—Ä–∞—Ö –∏–º —Ä–∞—Å—Å–∫–∞–∑—ã–≤–∞—é—Ç –ø—Ä–æ –π–æ–≥—É –∏ —ç–∑–æ—Ç–µ—Ä–∏–∫—É, –∏ –ø–æ—Å—Ç–∞—Ä–∞–ª–∏—Å—å –∑–∞—â–∏—Ç–∏—Ç—å –ù–∞—Ç–∞–ª–∏—é –ë—è—á–∫–æ–≤—É. –ö–∞–∫ –≥–æ–≤–æ—Ä–∏—Ç –∏—Å—Ç–æ—á–Ω–∏–∫, —Å—Ç–∞—Ä—à–µ–∫—É—Ä—Å–Ω–∏–∫–∏ –ø—Ä–∏—à–ª–∏ –∫ –ø—Ä–æ—Ä–µ–∫—Ç–æ—Ä–∫–µ –ø–æ —É—á–µ–±–Ω–æ–π —Ä–∞–±–æ—Ç–µ –ê–Ω–Ω–µ –ì–∞–±–¥—É—Ä–∞—Ñ–∏–∫–æ–≤–æ–π, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–ø—Ä–∞–≤–∏–ª–∞ –∏—Ö –∫ –∏—Å–ø–æ–ª–Ω—è—é—â–µ–π –æ–±—è–∑–∞–Ω–Ω–æ—Å—Ç–∏ –¥–µ–∫–∞–Ω–∞ –º–µ—Ö–º–∞—Ç–∞ –ú–∞—Ä–∏–Ω–µ –ë–∞—Ä—É–ª–∏–Ω–æ–π. –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –¥–æ –¥–µ–∫–∞–Ω–∞—Ç–∞ —Å—Ç—É–¥–µ–Ω—Ç—ã –Ω–µ –¥–æ–±—Ä–∞–ª–∏—Å—å. –ò—Å—Ç–æ—á–Ω–∏–∫ —É—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ —Å—Ç–∞—Ä—à–µ–∫—É—Ä—Å–Ω–∏–∫–∏ –ø–µ—Ä–µ–¥ —ç—Ç–∏–º –æ–±—Ä–∞—Ç–∏–ª–∏—Å—å –∫ –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –±—ã–≤—à–∏–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º –∫–∞—Ñ–µ–¥—Ä—ã –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞–º–µ–∫–Ω—É–ª–∏ —Ä–µ–±—è—Ç–∞–º, —á—Ç–æ —É —Ç–µ—Ö –±—É–¥—É—Ç –ø—Ä–æ–±–ª–µ–º—ã –Ω–∞ –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–æ–º —ç–∫–∑–∞–º–µ–Ω–µ –∏ –∑–∞—â–∏—Ç–µ –í–ö–†. –ü–æ—Å–ª–µ –¥–∞–≤–ª–µ–Ω–∏—è —Å–æ —Å—Ç–æ—Ä–æ–Ω—ã –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π —Å—Ç—É–¥–µ–Ω—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —É–≥–∞—Å–ª–∞. –ù–µ–º–∞–ª—É—é —Ä–æ–ª—å –≤ –∫—É–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ –Ω–µ–¥–æ–≤–æ–ª—å—Å—Ç–≤–∞ —Å—ã–≥—Ä–∞–ª–æ –∏ —Ç–æ, —á—Ç–æ —Å—Ç–∞—Ä—à–µ–∫—É—Ä—Å–Ω–∏–∫–∞–º –æ–±–µ—â–∞–ª–∏ –ø–æ—Å—Ç–∞–≤–∏—Ç—å —Ö–æ—Ä–æ—à–∏–µ –æ—Ü–µ–Ω–∫–∏, –µ—Å–ª–∏ –æ–Ω–∏ —Ö–æ—Ç—è –±—ã –±—É–¥—É—Ç –ø–æ—Å–µ—â–∞—Ç—å –ø–∞—Ä—ã. –ú–æ–¥–µ–ª—å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–∞ –ø–æ –ò–ë [–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏] —Ä–∞–∑—Ä—É—à–µ–Ω–∞ ‚Äì –ø–æ–¥—ã—Ç–æ–∂–∏–ª —Ä–∞—Å—Å–∫–∞–∑ –æ –∫–µ–π—Å–µ –ù–∞—Ç–∞–ª–∏–∏ –ë—è—á–∫–æ–≤–æ–π –æ–¥–∏–Ω –∏–∑ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤. –î–∏—Ä–µ–∫—Ç–æ—Ä –ò–¢-–∏–Ω—Å—Ç–∏—Ç—É—Ç–∞ –°–µ—Ä–≥–µ–π –ê–≤—Ç–∞–π–∫–∏–Ω –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª, —á—Ç–æ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—é, –∫–æ—Ç–æ—Ä–∞—è –≤—Ö–æ–¥–∏—Ç –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –ø–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –ø–µ—Ä–µ–¥–∞–ª–∏ –Ω–∞ –ø—Ä–æ—Ñ–∏–ª—å–Ω—É—é –∫–∞—Ñ–µ–¥—Ä—É ‚Äì –∫–∞—Ñ–µ–¥—Ä—É –ø—Å–∏—Ö–æ–ª–æ–≥–∏–∏ —Ä–∞–∑–≤–∏—Ç–∏—è. –û–Ω–∞ –ø–µ—á–∞–ª—å–Ω–æ –∏–∑–≤–µ—Å—Ç–Ω–∞ –≤ —É–∑–∫–∏—Ö –∫—Ä—É–≥–∞—Ö, –Ω–æ –Ω–µ —Å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π, –∞ —Å —ç—Ç–∏—á–µ—Å–∫–æ–π —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è. –ó–∞–≤–µ–¥—É—é—â–∞—è –∫–∞—Ñ–µ–¥—Ä–æ–π –°–≤–µ—Ç–ª–∞–Ω–∞ –ñ–¥–∞–Ω–æ–≤–∞ –∏ –µ—ë —Ä–∞–±–æ—Ç–Ω–∏—Ü–∞ –õ–∏–Ω–∞ –ó–∞—Ä–∏–ø–æ–≤–∞ –ø–∏—Å–∞–ª–∏ –≤–º–µ—Å—Ç–µ —Å –∫–æ–ª–ª–µ–≥–∞–º–∏ —Å –¥—Ä—É–≥–∏—Ö —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–æ–≤ —ç–∫—Å–ø–µ—Ä—Ç–∏–∑—É –ø–æ —Ä–µ–ø—Ä–µ—Å—Å–∏–≤–Ω–æ–º—É –¥–µ–ª—É –æ —á—É—á–µ–ª–µ –ü—É—Ç–∏–Ω–∞. –¢–æ–≥–¥–∞ —Ç—Ä–æ–∏–º –º–æ–ª–æ–¥—ã–º —Ä–µ–±—è—Ç–∞–º, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–∏–≤—è–∑–∞–ª–∏ –∫ —Å—Ç–æ–ª–±—É —É –¶–£–ú–∞ —Ñ–∏–≥—É—Ä—É —Å –ª–∏—Ü–æ–º –ø—Ä–µ–∑–∏–¥–µ–Ω—Ç–∞, –≥—Ä–æ–∑–∏–ª–æ –¥–æ —Å–µ–º–∏ –ª–µ—Ç —Ç—é—Ä—å–º—ã –∑–∞ —Ö—É–ª–∏–≥–∞–Ω—Å—Ç–≤–æ. –í —Ç–µ–∫—Å—Ç–µ —ç–∫—Å–ø–µ—Ä—Ç—ã –∏–∑ –ü–ì–ù–ò–£ –Ω–∞–∑—ã–≤–∞–ª–∏ —Ä–µ–ø—Ä–µ—Å—Å–∏—Ä—É–µ–º—ã—Ö –ø—Ä–∞–≤–æ–Ω–∞—Ä—É—à–∏—Ç–µ–ª—è–º–∏, —Ö–æ—Ç—è –≤—ã–Ω–æ—Å–∏—Ç—å –ø—Ä–∏–≥–æ–≤–æ—Ä—ã ‚Äì –¥–µ–ª–æ —Å—É–¥–∞, –∞ –Ω–µ –ø—Å–∏—Ö–æ–ª–æ–≥–æ–≤ –∏ –∏—Ö –∫–æ–ª–ª–µ–≥-–≥—É–º–∞–Ω–∏—Ç–∞—Ä–∏–µ–≤. –ü–æ–∑–∂–µ –æ–¥–∏–Ω –∏–∑ —Ä–µ–±—è—Ç –±—ã–ª –æ–ø—Ä–∞–≤–¥–∞–Ω, –∞ –∑–Ω–∞—á–∏—Ç —Ä–∞–±–æ—Ç–Ω–∏–∫–∏ –≤—É–∑–∞ –æ–±–æ–ª–≥–∞–ª–∏ –µ–≥–æ –¥–∞–∂–µ —Å —Ñ–æ—Ä–º–∞–ª—å–Ω–æ–π —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è. –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –≤ –∏—Ö —Ç–µ–∫—Å—Ç–µ –≤—ã–¥–≤–∏–≥–∞–ª–∞—Å—å –∫–æ–Ω—Å–ø–∏—Ä–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Ç–µ–æ—Ä–∏—è –æ —Ç–æ–º, —á—Ç–æ —Ä–µ–ø—Ä–µ—Å—Å–∏—Ä—É–µ–º—ã–µ –∞–∫—Ç–∏–≤–∏—Å—Ç—ã –±—ã–ª–∏ –Ω–∏–∑—à–∏–º –∑–≤–µ–Ω–æ–º, –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è–º–∏ —á—å–∏—Ö-—Ç–æ –∑–∞–∫–∞–∑–æ–≤, –∞ –∏—Ö –∞–∫—Ü–∏—è –±—ã–ª–∞ –∑–∞—Ä–∞–Ω–µ–µ —Å–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∏ –∑–∞–∫–∞–∑–Ω–æ–π. –≠–∫—Å–ø–µ—Ä—Ç–∏–∑–∞ –ø–µ—Å—Ç—Ä–∏–ª–∞ –∏ –¥—Ä—É–≥–∏–º–∏, –º–µ–Ω–µ–µ –∑–Ω–∞—á–∏–º—ã–º–∏ –º–µ–Ω—Ç–∞–ª—å–Ω—ã–º–∏ –∫—É–ª—å–±–∏—Ç–∞–º–∏, —Å –ø–æ–º–æ—â—å—é –∫–æ—Ç–æ—Ä—ã—Ö —Ä–µ–±—è—Ç –ø–æ–¥–≤–æ–¥–∏–ª–∏ –ø–æ–¥ —Ç—è–∂–∫—É—é —É–≥–æ–ª–æ–≤–Ω—É—é —Å—Ç–∞—Ç—å—é. –î—Ä—É–≥–æ–π —Ä–∞–±–æ—Ç–Ω–∏–∫ –∫–∞—Ñ–µ–¥—Ä—ã, –ú–∞–∫—Å–∏–º –ó—É–±–∞–∫–∏–Ω, –∑–∞–ø–æ–º–Ω–∏–ª—Å—è –º–æ–µ–π –≥—Ä—É–ø–ø–µ ‚Äì —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–µ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–º —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—è–º 2021 –≥–æ–¥–∞ –≤—ã–ø—É—Å–∫–∞ ‚Äì —Ç–µ–º, —á—Ç–æ –ø—Ä–∏ –≤—Å–µ—Ö –ø—Ä–µ–¥–ª–æ–∂–∏–ª –Ω–∞—à–µ–π –æ–¥–Ω–æ–≥—Ä—É–ø–ø–Ω–∏—Ü–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å—Å—è –Ω–∞ –∫—É—Ä—Å—ã –º–∏–Ω–µ—Ç–∞. –û–Ω–∞ —Ç–æ–≥–¥–∞ –æ–ø–æ–∑–¥–∞–ª–∞ –Ω–∞ –ø–∞—Ä—É –∏ –Ω–µ –ø—Ä–∏—à–ª–∞ –Ω–∞ –æ–¥–Ω—É –∏–ª–∏ –¥–≤–µ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö. –£ –º–µ–Ω—è —Å–æ—Ö—Ä–∞–Ω–∏–ª–∏—Å—å –ø–µ—Ä–µ–ø–∏—Å–∫–∏ —Å –æ–±—Å—É–∂–¥–µ–Ω–∏–µ–º —ç—Ç–æ–≥–æ —Å–ª—É—á–∞—è –∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç —Å—Ç—É–¥–µ–Ω—Ç–∫–∏ –¥—Ä—É–≥–æ–π –≥—Ä—É–ø–ø—ã, –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ —è –¥–µ–ª–∞—é –≤—ã–≤–æ–¥, —á—Ç–æ —Ç–∞–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –¥–ª—è –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è ‚Äì –Ω–µ —á—Ç–æ-—Ç–æ –Ω–µ–æ–±—ã—á–Ω–æ–µ. –í—ã–ø—É—Å–∫–Ω–∏—Ü–∞ –∫–∞—Ñ–µ–¥—Ä—ã –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –î–∏–Ω–∞—Ä–∞ –ê–ª–¥–∞—Ä–æ–≤–∞ –ø–æ–¥–µ–ª–∏–ª–∞—Å—å —Å–≤–æ–∏–º–∏ –º—ã—Å–ª—è–º–∏ –æ —Ç–æ–º, —á—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ —Å –ù–∞—Ç–∞–ª–∏–µ–π –ë—è—á–∫–æ–≤–æ–π:–ë—è—á–∫–æ–≤–∞ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–ª–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é –∫—É–ª—å—Ç—É—Ä—É. –û–±—É—á–∞—è —Å —ç—Ç–æ–π –∫—É–ª—å—Ç—É—Ä–æ–π —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–∞—Å. –ò –∑–∞–º–µ–Ω–∏—Ç—å –µ–µ –ø—Ä–æ—Å—Ç–æ –Ω–µ–∫–µ–º. –û–Ω–∞ –≤—Å–µ –±–æ—è–ª–∞—Å—å —ç—Ç–æ–≥–æ, –∞ –≤ –∏—Ç–æ–≥–µ –≤–∏–¥–∏–º–æ –ø–µ—Ä–µ–∂–∏–ª–∞ —Å–≤–æ—é –∂–µ –¥–æ–ª–∂–Ω–æ—Å—Ç—å –ú—ã [–∫–∞—Ñ–µ–¥—Ä–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏] –º–µ–Ω—è–ª–∏ —Å—Ç–∞—Ç—É—Å, –Ω–∞–∑–≤–∞–Ω–∏–µ, —Ñ–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –∑–∞–≤–µ–¥—É—é—â–µ–≥–æ, –Ω–∞–±—Ä–∞–ª–∏ –Ω–æ–≤–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ, –ø–æ–º–µ–Ω—è–ª–∏ –∫—É—á—É –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–µ–π, –ø–µ—Ä–µ—à–ª–∏ —Å —Å–µ–º–µ—Å—Ç—Ä–æ–≤ –∏ –∑–∞—á–µ—Ç–æ–∫ –Ω–∞ —Ç—Ä–∏–º–µ—Å—Ç—Ä—ã –∏ –±—Ä—Å [–±–∞–ª–ª—å–Ω–æ-—Ä–µ–π—Ç–∏–Ω–≥–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É], —Å –∂—É—Ä–Ω–∞–ª–æ–≤ —Å –æ—Ü–µ–Ω–∫–∞–º–∏ –Ω–∞ –ª–∏—Å—Ç–æ—á–∫–∏ –∂—É—Ä–Ω–∞–ª–æ–≤ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏, –ø–µ—Ä–µ–∂–∏–ª–∏ –¥–∏—Å—Ç–∞–Ω—Ç –∏ –∫–∞–∑—ë–Ω–Ω—ã–µ –º–∞—Å–∫–∏ –æ—Ç –∫–æ–≤–∏–¥–∞, –∏ –∫–∞—Ñ–µ–¥—Ä–∞ –º–µ–Ω—è–ª–∞—Å—å, –Ω–æ[...] –í—Å–µ, —è –Ω–µ–∫—Ä–æ–ª–æ–≥ –∫–∞—Ñ–µ–¥—Ä–µ –ø–∏—à—É. –° –∑–∞–≥–æ–ª–æ–≤–∫–æ–º –ù–µ –ø–æ—Å—Ç—É–ø–∞–π—Ç–µ –Ω–∞ –º–µ—Ö–º–∞—Ç. –ò–∑–≤–∏–Ω–∏—Ç–µ.–ö—Ä–æ–º–µ –ù–∞—Ç–∞–ª–∏–∏ –ë—è—á–∫–æ–≤–æ–π, –≤ —Å–ø–∏—Å–∫–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∫–∞—Ñ–µ–¥—Ä—ã –æ—Å—Ç–∞–ª–∞—Å—å –¢–∞—Ç—å—è–Ω–∞ –†–æ–º–∞—à–∫–∏–Ω–∞. –ö–∞–∫ –≥–æ–≤–æ—Ä—è—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∏, –†–æ–º–∞—à–∫–∏–Ω–∞ —Ä–µ—à–∏–ª–∞ –ø–µ—Ä–µ–π—Ç–∏ –≤ –ò–¢-–∏–Ω—Å—Ç–∏—Ç—É—Ç –≤–º–µ—Å—Ç–µ —Å –∫–æ–ª–ª–µ–≥–∞–º–∏, –Ω–æ –æ—Ç–¥–µ–ª –∫–∞–¥—Ä–æ–≤, —á—å—ë —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏–ª—å–Ω–æ –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç –∫–æ–ª–ª–∞–ø—Å, –¥–æ —Å–∏—Ö –ø–æ—Ä –Ω–µ –∑–∞–∫–æ–Ω—á–∏–ª –µ—ë –ø–µ—Ä–µ–≤–æ–¥.–ë—ã–≤—à–∏–π –∑–∞–≤–µ–¥—É—é—â–∏–π –∫–∞—Ñ–µ–¥—Ä–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –¥–µ–∫–∞–Ω –º–µ—Ö–º–∞—Ç–∞ –ê–Ω–¥—Ä–µ–π –ö—É–∑–Ω–µ—Ü–æ–≤ –º–æ–≥ –±—ã —É–ø—Ä–∞–≤–ª—è—Ç—å –∫–æ–ª–ª–µ–∫—Ç–∏–≤–æ–º –∏–∑ –æ–¥–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞, –Ω–æ, –∫–∞–∫ –∏ –ë—è—á–∫–æ–≤–∞, –æ—Å—Ç–∞—ë—Ç—Å—è –±–µ–∑ –Ω–∞–≥—Ä—É–∑–∫–∏. –û–Ω –¥–æ–ª–∂–µ–Ω –±—ã–ª —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –ò–¢-–∏–Ω—Å—Ç–∏—Ç—É—Ç–µ –∏ –Ω–∞ –∫–∞—Ñ–µ–¥—Ä–µ –ü–ú–ò –º–µ—Ö–∞–Ω–∏–∫–æ-–º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–∞, –Ω–æ –∏–Ω—Å—Ç–∏—Ç—É—Ç—Å–∫—É—é –Ω–∞–≥—Ä—É–∑–∫—É —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–µ—Ä–µ–¥–∞–ª–æ –¥—Ä—É–≥–∏–º –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—è–º, –∞ –∫—Ä–æ—à–µ—á–Ω–∞—è –¥–æ–ª—è —Å—Ç–∞–≤–∫–∏ –Ω–∞ –ü–ú–ò –ø–æ–∫–∞ –ø–æ–¥ –≤–æ–ø—Ä–æ—Å–æ–º.–ö—Ä–æ–º–µ –∏—Å—Ç–æ—Ä–∏–∏ –ù–∞—Ç–∞–ª–∏–∏ –ë—è—á–∫–æ–≤–æ–π, –º–µ–Ω—è –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–ª–æ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –°–µ—Ä–≥–µ—è –ê–≤—Ç–∞–π–∫–∏–Ω–∞ –∫ –ø—Å–∏—Ö–æ–ª–æ–≥–∏–∏ –∫–∞–∫ –ø—Ä–µ–¥–º–µ—Ç—É: –≥–ª–∞–≤–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ —Å–ø–µ—Ä–≤–∞ –ø—Ä–∏–ø–∏—Å–∞–ª –µ–º—É —Ñ—Ä–∞–∑—É –ø—Å–∏—Ö–æ–ª–æ–≥–∏—è –±—É–¥–µ—Ç —Å—Ç—É–¥–µ–Ω—Ç–∞–º —Ç–æ–ª—å–∫–æ –º–µ—à–∞—Ç—å. –ö–æ–≥–¥–∞ —è —Å–ø—Ä–æ—Å–∏–ª —É –¥–∏—Ä–µ–∫—Ç–æ—Ä–∞ –ò–¢-–∏–Ω—Å—Ç–∏—Ç—É—Ç–∞, –ø—Ä–∞–≤–¥–∞ –ª–∏ –æ–Ω —Ç–∞–∫ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ —á—Ç–µ–Ω–∏—é –ø—Ä–µ–¥–º–µ—Ç–∞ –±–µ–∑–æ–ø–∞—Å–Ω–∏–∫–∞–º, —Ç–æ—Ç –æ—Ç–≤–µ—Ç–∏–ª: –ø–æ–ª–Ω—ã–π –±—Ä–µ–¥. –î–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–∏–∫–æ–≤ —ç—Ç–æ –∂–∏–∑–Ω–µ–Ω–Ω–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞—è –¥–∏—Å—Ü–∏–ø–ª–∏–Ω–∞, —Ç–∞–∫ –∫–∞–∫ —ç—Ç–æ –¥–æ–≤–æ–ª—å–Ω–æ –±–æ–ª—å—à–æ–π –ø–ª–∞—Å—Ç –∏—Ö –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏. –•–æ—Ç—è –±—ã –ø–æ—Ç–æ–º—É, —á—Ç–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ —É—Ç–µ—á–µ–∫ —ç—Ç–æ –ª—é–¥–∏ –∏ –∏—Ö –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ. –ü–æ–∑–∂–µ —è —É—Ç–æ—á–Ω–∏–ª —É —Å–≤–æ–µ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞, —á—Ç–æ –æ–Ω –∏–º–µ–ª –≤ –≤–∏–¥—É. –¢–æ—Ç –ø–æ—è—Å–Ω–∏–ª, —á—Ç–æ —É –ê–≤—Ç–∞–π–∫–∏–Ω–∞ –∏ –ë—è—á–∫–æ–≤–æ–π –±—ã–ª —Ä–∞–∑–≥–æ–≤–æ—Ä, –≤ –∫–æ—Ç–æ—Ä–æ–º –¥–∏—Ä–µ–∫—Ç–æ—Ä –∏–Ω—Å—Ç–∏—Ç—É—Ç–∞ –∑–∞—è–≤–∏–ª, —á—Ç–æ —Ö–æ—á–µ—Ç –≤—ã–≤–µ—Å—Ç–∏ –ø—Å–∏—Ö–æ–ª–æ–≥–∏—é –Ω–∞ –≤–Ω–µ—à–Ω–∏–π –∫–æ–Ω—Ç—É—Ä, —á—Ç–æ–±—ã —Å—Ç—É–¥–µ–Ω—Ç—ã –Ω–µ –æ—Ç–≤–ª–µ–∫–∞–ª–∏—Å—å, –∏ –ø–æ–∫–∞–∑–∞–ª –Ω–µ—Å–µ—Ä—å—ë–∑–Ω–æ–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ –∫ –ø—Ä–µ–¥–º–µ—Ç—É. –Ø —É–≤–µ—Ä–µ–Ω, —á—Ç–æ –ø–æ–¥–æ–±–Ω—ã–π —Ä–∞–∑–≥–æ–≤–æ—Ä –∏ –ø—Ä–∞–≤–¥–∞ —Å–æ—Å—Ç–æ—è–ª—Å—è. –ü–æ—Ö–æ–∂–µ, –ø–æ—Å–ª–µ –Ω–µ–≥–æ –°–µ—Ä–≥–µ–π –ê–≤—Ç–∞–π–∫–∏–Ω –∏–∑–º–µ–Ω–∏–ª –ø–æ–∑–∏—Ü–∏—é.":[],
"–£–≤–∞–∂–∞–µ–º—ã–µ —Å—Ç—É–¥–µ–Ω—Ç—ã 3 –∫—É—Ä—Å–∞! ‚Äº–ë–æ–ª—å—à–∞—è –ø—Ä–æ—Å—å–±–∞ –ø—Ä–∏—Ö–æ–¥–∏—Ç—å —Å–¥–∞–≤–∞—Ç—å –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ —Ä–∞–±–æ—Ç—ã –¢–û–õ–¨–ö–û –í–û –í–†–ï–ú–Ø –°–í–û–ò–• –ü–ê–†! –Ø –Ω–µ –±—É–¥—É—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–∞–¥–∞–Ω–∏—è –≤–æ –≤—Ä–µ–º—è –∑–∞–Ω—è—Ç–∏–π 1 –∫—É—Ä—Å–∞ –∏ –≤ –¥—Ä—É–≥–æ–µ –≤—Ä–µ–º—è –º–µ–∂–¥—É –ø–∞—Ä–∞–º–∏, —Ç–∞–∫ –∫–∞–∫ —É –º–µ–Ω—è –º–Ω–æ–≥–æ –¥—Ä—É–≥–∏—Ö –¥–µ–ª. –ê —Ç–æ —è, —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø—Ä–∏–µ–∑–∂–∞–ª–∞ –Ω–∞ –ø–∞—Ä—É –≤–æ –≤—Ç–æ—Ä–Ω–∏–∫ –∏ –Ω–µ –±—ã–ª–æ –Ω–∏ –æ–¥–Ω–æ–≥–æ —Å—Ç—É–¥–µ–Ω—Ç–∞ (–ø—Ä–∏–µ–∑–∂–∞—é —Ä–∞–¥–∏ –û–î–ù–û–ô –≤–∞—à–µ–π –ø–∞—Ä—ã)!! –ù–æ –ø—Ä–∏ —ç—Ç–æ–º –≤—ã —Ä–∞–¥–∏ –æ–¥–Ω–æ–π –ø–∞—Ä—ã –µ–∑–¥–∏—Ç—å –Ω–∞ –∑–∞–Ω—è—Ç–∏—è –Ω–µ –∂–µ–ª–∞–µ—Ç–µ. –í—ã —Å—á–∏—Ç–∞–µ—Ç–µ —Å–µ–±—è –±–æ–ª–µ–µ –∑–∞–Ω—è—Ç—ã–º–∏ –ª—é–¥—å–º–∏ —á–µ–º –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏?? üò° –ï—â–µ —Ä–∞–∑ –ø–æ–≤—Ç–æ—Ä—è—é –≥—Ä–∞—Ñ–∏–∫ –ø—Ä–∏–µ–º–∞ –∑–∞–¥–∞–Ω–∏–π: - –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ 4 –ø–∞—Ä–∞ - –≤—Ç–æ—Ä–Ω–∏–∫ 4 –ø–∞—Ä–∞ - —á–µ—Ç–≤–µ—Ä–≥ 4 –ø–∞—Ä–∞ - –ø—è—Ç–Ω–∏—Ü–∞ 3 –∏ 4 –ø–∞—Ä–∞ –°—Ä–æ–∫ —Å–¥–∞—á–∏ –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–æ–π —Ä–∞–±–æ—Ç—ã ‚Ññ5 - 22 –º–∞—Ä—Ç–∞!":[],
"–ú–æ–µ —Ä–µ—à–µ–Ω–∏–µ –ø–æ –ø–æ–≤–æ–¥—É –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã –¥–ª—è 1 –∫—É—Ä—Å–∞. –í—Å–µ–π –≥—Ä—É–ø–ø–µ –ò–¢–•-1,2 –∑–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—É—é —Ä–∞–±–æ—Ç—É ‚Ññ1 –±–∞–ª–ª—ã —Å–Ω–∏–∂–µ–Ω—ã –≤ 2 —Ä–∞–∑–∞. –ö–æ–≥–æ –Ω–µ —É—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç —ç—Ç–∞ –æ—Ü–µ–Ω–∫–∞, –∏–º–µ—é—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—É—é (–µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω–æ, –¥—Ä—É–≥–æ–π –≤–∞—Ä–∏–∞–Ω—Ç) –≤ –ø—è—Ç–Ω–∏—Ü—É (22 –º–∞—Ä—Ç–∞) –≤ 13.30 –≤ –∞—É–¥.522. –°—Ä–∞–∑—É –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–∞—é, —á—Ç–æ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è –±—É–¥–µ—Ç —Å–ª–æ–∂–Ω–µ–µ! –¢–∞–∫ —á—Ç–æ 100 —Ä–∞–∑ –ø–æ–¥—É–º–∞–π—Ç–µ, —Å—Ç–æ–∏—Ç –ª–∏ –≤–∞–º –µ–µ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞—Ç—å. –í —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ –¥–ª—è –≥—Ä—É–ø–ø—ã –ò–¢–• –±—É–¥–µ—Ç –æ—Ç–¥–µ–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –∏ —Å—Ç—Ä–æ–≥–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –∑–∞ —Å–ø–∏—Å—ã–≤–∞–Ω–∏–µ–º. –ì—Ä—É–ø–ø—ã –ü–ú–ò –±—É–¥—É—Ç –ø–µ—Ä–µ–¥ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ–º —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–æ–π —Å–¥–∞–≤–∞—Ç—å —Ç–µ–ª–µ—Ñ–æ–Ω—ã! –ï—â–µ —Ä–∞–∑ —Ç–∞–∫–æ–µ –ø–æ–≤—Ç–æ—Ä–∏—Ç—Å—è, –æ—Ü–µ–Ω–∫—É 0 –∑–∞ –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω—É—é –∏–ª–∏ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω—É—é (!!) —Ä–∞–±–æ—Ç—É –ø–æ–ª—É—á–∞—Ç –í–°–ï –≥—Ä—É–ø–ø—ã –±–µ–∑ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏—è –≤ —ç—Ç–æ–º —Å–µ–º–µ—Å—Ç—Ä–µ!":[],
"–í—Å–µ–º –ø—Ä–∏–≤–µ—Ç": [],
"–í—Å–µ–º —Å—Ç—É–¥–µ–Ω—Ç–∞–º, –ø—Ä–æ—à–µ–¥—à–∏–º –∞—Å—Å–µ—Å–º–µ–Ω—Ç, –¥–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ 2 –±–∞–ª–ª–∞ –∑–∞ –ö–¢2.": ["–Ø –±–µ–∑—É–º–Ω–æ —Ä–∞–¥, —Å–ø–∞—Å–∏–±–æ","–ü–æ—á–µ–º—É –æ–ø—è—Ç—å –≤—Å–µ–º –∫—Ä–æ–º–µ –º–µ–Ω—è???","–î–æ–±–∞–≤—å—Ç–µ –≤—Å–µ–º"],
"–°–µ–≥–æ–¥–Ω—è –∫ –ø–µ—Ä–≤–æ–π –ø–∞—Ä–µ –Ω–∏–∫—Ç–æ –Ω–µ –ø—Ä–∏—à—ë–ª, —è –æ—á–µ–Ω—å –∑–ª–∞ –Ω–∞ –≤–∞—Å, –ø–æ—Ç—Ä–∞—Ç–∏–ª–∞ —Å—Ç–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏.": ["–ò–∑–≤–∏–Ω–∏—Ç–µ –Ω–∞—Å","–î–∞ –∫—Ç–æ –≤–æ–æ–±—â–µ –∑–∞—Ö–æ—á–µ—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç—å –∫ –ø–µ—Ä–≤–æ–π –ø–∞—Ä–µ"],
}

fp = open('C:/–ù–µ–π—Ä–æ–Ω–∫–∞/–≤—ã–≤–æ–¥.txt','w') # –æ—Ç–∫—Ä—ã—Ç—å —Ñ–∞–π–ª –∏–∑ –ª—é–±–æ–≥–æ –∫–∞—Ç–∞–ª–æ–≥–∞
fn = 'C:/–ù–µ–π—Ä–æ–Ω–∫–∞/Otchet.xlsx'
wb = load_workbook(fn)
ws = wb['–õ–∏—Å—Ç1']
ws['A1'] = '–ü–æ—Å—Ç'
ws['E1'] = '–û—Ü–µ–Ω–∫–∞'
ws['H1'] = '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã—Ö'
ws['K1'] = '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã—Ö'
ws['O1'] = '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –Ω–µ–≥–∞—Ç–∏–≤–Ω—ã—Ö'
ws['R1'] = '–°—Å—ã–ª–∫–∞ –Ω–∞ –ø–æ—Å—Ç'
wb.save(fn)
count = 0

def excel(All_t):
    global fn
    global wb
    global ws
    global countp
    global counto
    global counts
    global countneg
    global countn
    global countpos
    global countnege
    global countne
    global countpose
    for key, values in All_t.items():

        if key == '–ü–æ—Å—Ç':
            ws[f'A{countp}'] = values
            countp = countp + 1

        elif key == '–æ—Ü–µ–Ω–∫–∞':
            ws[f'E{counto}'] = values
            counto = counto + 1

        elif key == '–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏':
            for v1 in values:
                toxicity = predict(v1)
                if toxicity == 0:
                    countn = countn + 1
                elif toxicity == 1:
                    countpos = countpos + 1
                elif toxicity == 2:
                    countneg = countneg + 1

        elif key =='—Å—Å—ã–ª–∫–∞':
            ws[f'R{counts}'].hyperlink = values
            ws[f'R{counts}'].style='Hyperlink'
            counts = counts + 1

        wb.save(fn)
    ws[f'H{countpose}'] = countpos
    ws[f'K{countne}'] = countn
    ws[f'O{countnege}'] = countneg
    countpose = countpose + 1
    countne = countne + 1
    countnege = countnege + 1
    countneg = 0
    countpos = 0
    countn = 0
    wb.save(fn)


for i in range(1,25):
    All_text = get_All('psu_community',i)
    excel(All_text)



wb.save(fn)
wb.close()

fp.close()
